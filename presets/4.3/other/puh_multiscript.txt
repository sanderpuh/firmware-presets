#$ TITLE: SanderPuh - Multiscript Racing Setup BF4.4
#$ FIRMWARE_VERSION: 4.2
#$ FIRMWARE_VERSION: 4.3
#$ FIRMWARE_VERSION: 4.4
#$ CATEGORY: OTHER
#$ STATUS: EXPERIMENTAL
#$ KEYWORDS: puh, analog, osd, vtx, reset, mode, modes, adjustments, aux, switch,
#$ AUTHOR: Sander Puttenstein

#$ PARSER: MARKED

#$ DESCRIPTION: 
#$ DESCRIPTION: Information:
#$ DESCRIPTION: -----------
#$ DESCRIPTION: General Setup of a new drone. Use configuration options to select applicable configurations
#$ DESCRIPTION: 
#$ DESCRIPTION: Elements Include:
#$ DESCRIPTION: -----------
#$ DESCRIPTION: VTX, OSD, Launch control, RC link, Rates, Tune, Filters, etc...
#$ DESCRIPTION: 



#$ OPTION_GROUP BEGIN: PID Tuning - CHOOSE ONLY ONE!
  # -- Race tune settings --
  #$ OPTION BEGIN (UNCHECKED): 5 Inch 6S
  #$ INCLUDE: presets/4.4/tune/defaults.txt
  set p_pitch = 41
  set i_pitch = 86
  set d_pitch = 37
  set f_pitch = 137
  
  set p_roll = 38
  set i_roll = 78
  set d_roll = 34
  set f_roll = 125

  set p_yaw = 45
  set i_yaw = 80
  set f_yaw = 120
  set d_min_roll = 25
  set d_min_pitch = 27
  
  set simplified_pids_mode = RP
  set simplified_master_multiplier = 100
  set simplified_i_gain = 115
  set simplified_d_gain = 85
  set simplified_pi_gain = 85
  set simplified_dmax_gain = 100
  set simplified_feedforward_gain = 105
  set simplified_pitch_d_gain = 95
  set simplified_pitch_pi_gain = 105
  #$ OPTION END
#$ OPTION_GROUP END



# -- Dshot & RPM filter settings --
#$ OPTION_GROUP BEGIN: Dshot - CHOOSE ONLY ONE!
  #$ OPTION BEGIN (UNCHECKED): Dshot300 (F4 or BMI)
  #$ INCLUDE_WARNING: misc/warnings/en/dshot.txt
  set motor_pwm_protocol = Dshot300
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): Dshot600 (F7)
  #$ INCLUDE_WARNING: misc/warnings/en/dshot.txt
  set motor_pwm_protocol = Dshot600
  #$ OPTION END
#$ OPTION_GROUP END

#$ OPTION_GROUP BEGIN: RPM Filters - CHOOSE ONLY ONE!
  #$ OPTION BEGIN (UNCHECKED): VERY CLEAN build
  #$ INCLUDE_WARNING: misc/warnings/en/rpm_filters.txt
  #$ INCLUDE: presets/4.3/filters/defaults.txt
  set dshot_bidir = ON
  set gyro_lpf1_dyn_min_hz = 0
  set gyro_lpf1_dyn_max_hz = 1000
  set gyro_lpf1_static_hz = 0
  set gyro_lpf2_static_hz = 1000
  set simplified_gyro_filter_multiplier = 200
  set dyn_notch_count = 1
  set dyn_notch_q = 500
  set rpm_filter_q = 750
  set dterm_lpf1_dyn_min_hz = 82
  set dterm_lpf1_dyn_max_hz = 165
  set dterm_lpf1_static_hz = 165
  set dterm_lpf2_static_hz = 165
  set simplified_dterm_filter_multiplier = 110
  #$ OPTION END
  
  #$ OPTION BEGIN (UNCHECKED): CLEAN build
  #$ INCLUDE_WARNING: misc/warnings/en/rpm_filters.txt
  #$ INCLUDE: presets/4.3/filters/defaults.txt
  set dshot_bidir = ON
  set gyro_lpf1_dyn_min_hz = 0
  set gyro_lpf1_dyn_max_hz = 875
  set gyro_lpf1_static_hz = 0
  set gyro_lpf2_static_hz = 875
  set simplified_gyro_filter_multiplier = 175
  set dyn_notch_count = 1
  set dyn_notch_q = 300
  set rpm_filter_q = 650
  set dterm_lpf1_dyn_min_hz = 78
  set dterm_lpf1_dyn_max_hz = 157
  set dterm_lpf1_static_hz = 157
  set dterm_lpf2_static_hz = 157
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): NORMAL build
  #$ INCLUDE_WARNING: misc/warnings/en/rpm_filters.txt
  #$ INCLUDE: presets/4.3/filters/defaults.txt
  set dshot_bidir = ON
  set gyro_lpf1_dyn_min_hz = 0
  set gyro_lpf1_dyn_max_hz = 500
  set gyro_lpf1_static_hz = 0
  set gyro_lpf2_static_hz = 500
  set simplified_gyro_filter_multiplier = 100
  set dyn_notch_count = 2
  set dyn_notch_q = 450
  set dyn_notch_min_hz = 100
  set rpm_filter_q = 500
  #$ OPTION END
#$ OPTION_GROUP END



# -- FC specific group settings --
#$ OPTION_GROUP BEGIN: FC specific
  #$ OPTION BEGIN (UNCHECKED): Foxeer F722 V1
  serial 0 64 115200 57600 0 115200
  set align_board_yaw = 180
  set motor_pwm_protocol = Dshot600
  #$ OPTION END
  
  #$ OPTION BEGIN (UNCHECKED): Diatone Mamba F4 (Target: FURYF4OSD)
  serial 2 0 115200 57600 0 115200
  serial 5 64 115200 57600 0 115200
  set motor_pwm_protocol = Dshot300  
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): HGLRC Airbus F4
  serial 2 64 115200 57600 0 115200
  set motor_pwm_protocol = Dshot300
  #$ OPTION END
#$ OPTION_GROUP END



# -- Miscellaneous --
#$ OPTION_GROUP BEGIN: Miscellaneous settings
  #$ OPTION BEGIN (UNCHECKED): Custom defaults
  set pilot_name = PUH
  set craft_name = -
  set osd_craft_name_pos = 234
  set small_angle = 180
  set min_check = 1020
  set max_check = 1980
  set min_throttle = 1020
  beeper -ON_USB
  beacon RX_LOST
  beacon RX_SET
  feature -TELEMETRY
  set debug_mode = GYRO_SCALED
  set yaw_motors_reversed = ON
  #$ OPTION END
 
  # -- AUX switch settings --
  #$ OPTION BEGIN (UNCHECKED): Aux switches
  #$ INCLUDE: presets/4.3/modes/defaults.txt
  aux 0 0 0 1900 2100 0 0
  aux 1 13 3 1900 2100 0 0
  aux 2 26 0 1900 2100 0 0
  aux 3 35 2 1900 2100 0 0
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): Launch Control switch
  aux 4 49 1 1400 1600 0 0
  #$ OPTION END
  

  # -- Launch control settings --
  #$ OPTION BEGIN (UNCHECKED): Launch Control
  aux 4 49 1 1400 1600 0 0
  set launch_control_mode = PITCHONLY
  set launch_angle_limit = 70
  set launch_trigger_allow_reset = ON
  set launch_trigger_throttle_percent = 20
  set launch_angle_limit = 70
  set launch_control_gain = 40
  #$ OPTION END

  # -- OSD settings --
  #$ OPTION BEGIN (UNCHECKED): OSD
  set vcd_video_system = NTSC
  set osd_logo_on_arming = ON
  set osd_tim1 = 2561
  set osd_vbat_pos = 393
  set osd_link_quality_pos = 2410
  set osd_tim_2_pos = 2447
  set osd_flymode_pos = 409
  set osd_throttle_pos = 2417
  set osd_vtx_channel_pos = 373
  set osd_current_pos = 352
  set osd_mah_drawn_pos = 386
  set osd_pilot_name_pos = 2061
  set osd_warnings_pos = 14666
  set osd_avg_cell_voltage_pos = 2442
  set osd_canvas_width = 30
  set osd_canvas_height = 13
  set osd_menu_background = GRAY
  #$ OPTION END
 
  # -- RC Link 250hz race settings --
  #$ OPTION BEGIN (UNCHECKED): RC link Race 250Hz (Tracer / ELRS)
  #$ INCLUDE: presets/4.3/rc_link/defaults.txt
  feature RX_SERIAL
  set serialrx_provider = CRSF
  set feedforward_averaging = 2_POINT
  set feedforward_smooth_factor = 35
  set feedforward_jitter_factor = 4
  set feedforward_boost = 18
  set rc_smoothing_auto_factor = 25
  set rc_smoothing_auto_factor_throttle = 25
  #$ OPTION END

  # -- Rate settings --
  #$ OPTION BEGIN (UNCHECKED): SanderPuh Rates
  #$ INCLUDE: presets/4.3/rates/defaults.txt
  set rates_type = BETAFLIGHT
  set roll_rc_rate = 90
  set pitch_rc_rate = 90
  set yaw_rc_rate = 80
  set roll_srate = 70
  set pitch_srate = 70
  set yaw_srate = 70
  #$ OPTION END
  
  # -- ELRS Betaflight passthrough -- 
  #$ OPTION BEGIN (UNCHECKED): Enable ELRS Betaflight passthrough
  feature -TELEMETRY
  set serialrx_inverted = off
  set serialrx_halfduplex = off
  #$ OPTION END
#$ OPTION_GROUP END



# -- VTX table group settings --
#$ OPTION_GROUP BEGIN: VTX table options - CHOOSE ONLY ONE!
  #$ INCLUDE_DISCLAIMER: misc/disclaimer/en/vtxtable.txt

  #$ OPTION BEGIN (UNCHECKED): TBS Unify Pro Nano SA2.0 (2 powerlevels)
  vtxtable bands 5
  vtxtable channels 8
  vtxtable band 1 BOSCAM_A A FACTORY 5865 5845 5825 5805 5785 5765 5745 5725
  vtxtable band 2 BOSCAM_B B FACTORY 5733 5752 5771 5790 5809 5828 5847 5866
  vtxtable band 3 BOSCAM_E E FACTORY 5705 5685 5665 5645 5885 5905 5925 5945
  vtxtable band 4 FATSHARK F FACTORY 5740 5760 5780 5800 5820 5840 5860 5880
  vtxtable band 5 RACEBAND R FACTORY 5658 5695 5732 5769 5806 5843 5880 5917
  vtxtable powerlevels 2
  vtxtable powervalues 0 1
  vtxtable powerlabels 25 50
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): SmartAudio 2.0 (4 powerlevels)
  vtxtable bands 5
  vtxtable channels 8
  vtxtable band 1 BOSCAM_A A FACTORY 5865 5845 5825 5805 5785 5765 5745 5725
  vtxtable band 2 BOSCAM_B B FACTORY 5733 5752 5771 5790 5809 5828 5847 5866
  vtxtable band 3 BOSCAM_E E FACTORY 5705 5685 5665 5645 5885 5905 5925 5945
  vtxtable band 4 FATSHARK F FACTORY 5740 5760 5780 5800 5820 5840 5860 5880
  vtxtable band 5 RACEBAND R FACTORY 5658 5695 5732 5769 5806 5843 5880 5917
  vtxtable powerlevels 4
  vtxtable powervalues 0 1 2 3
  vtxtable powerlabels 25 200 500 800
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): TBS Unify Pro32 Nano SA2.1
  vtxtable bands 5
  vtxtable channels 8
  vtxtable band 1 BOSCAM_A A FACTORY 5865 5845 5825 5805 5785 5765 5745 5725
  vtxtable band 2 BOSCAM_B B FACTORY 5733 5752 5771 5790 5809 5828 5847 5866
  vtxtable band 3 BOSCAM_E E FACTORY 5705 5685 5665 5645 5885 5905 5925 5945
  vtxtable band 4 FATSHARK F FACTORY 5740 5760 5780 5800 5820 5840 5860 5880
  vtxtable band 5 RACEBAND R FACTORY 5658 5695 5732 5769 5806 5843 5880 5917
  vtxtable powerlevels 4
  vtxtable powervalues 14 20 26 36
  vtxtable powerlabels 25 100 400 MAX
  #$ OPTION END

  #$ OPTION BEGIN (UNCHECKED): Rush Tiny Tank SA2.1
  vtxtable bands 5
  vtxtable channels 8
  vtxtable band 1 BOSCAM_A A FACTORY 5865 5845 5825 5805 5785 5765 5745 5725
  vtxtable band 2 BOSCAM_B B FACTORY 5733 5752 5771 5790 5809 5828 5847 5866
  vtxtable band 3 BOSCAM_E E FACTORY 5705 5685 5665 5645 5885 5905 5925 5945
  vtxtable band 4 FATSHARK F FACTORY 5740 5760 5780 5800 5820 5840 5860 5880
  vtxtable band 5 RACEBAND R FACTORY 5658 5695 5732 5769 5806 5843 5880 5917
  vtxtable powerlevels 4
  vtxtable powervalues 14 20 23 25
  vtxtable powerlabels 25 100 200 350
  #$ OPTION END
#$ OPTION_GROUP END
